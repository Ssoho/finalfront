{"ast":null,"code":"import _regeneratorRuntime from\"C:/\\uBC15\\uD604\\uD638/\\uD504\\uB85C\\uC81D\\uD2B8/react-jwt-auth/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/\\uBC15\\uD604\\uD638/\\uD504\\uB85C\\uC81D\\uD2B8/react-jwt-auth/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/\\uBC15\\uD604\\uD638/\\uD504\\uB85C\\uC81D\\uD2B8/react-jwt-auth/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{useState}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import Recommend1 from'./Recommend1';import Recommend2 from'./Recommend2';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Signrecommend(props){var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showAlert=_useState2[0],setShowAlert=_useState2[1];// 경고창 노출 여부 상태 추가  \nvar closeAlert=function closeAlert(){setShowAlert(false);// 경고창 닫기\n};var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),reco=_useState4[0],setReco=_useState4[1];// const [selectedItems, setSelectedItems] = useState(new Set());\n// const selectedItemsArray = Array.from(selectedItems);\nvar _useState5=useState(new Set()),_useState6=_slicedToArray(_useState5,2),selectedSongs=_useState6[0],setSelectedSongs=_useState6[1];var selectedSongsArray=Array.from(selectedSongs);var _useState7=useState(new Set()),_useState8=_slicedToArray(_useState7,2),selectedIds=_useState8[0],setSelectedIds=_useState8[1];var selectedIdsArray=Array.from(selectedIds);var axiosConfig={headers:{'Content-Type':'application/json'}};// const handleSelectedItemsChange = (items) => {\n//   setSelectedItems(new Set(items));\n// };    \nvar handleSelectedSongsChange=function handleSelectedSongsChange(songs){setSelectedSongs(new Set(songs));};var handleSelectedIdsChange=function handleSelectedIdsChange(ids){setSelectedIds(new Set(ids));};var handleRecommendSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var songs,userId;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();// 선택한 장르와 노래 목록을 서버로 전송\n// const tags = {\n//   tag: JSON.stringify(selectedItemsArray),\n// };\nsongs={song_ids:JSON.stringify(selectedIdsArray)};userId=JSON.parse(localStorage.getItem('user')).id;_context.prev=3;_context.next=6;return axios.put(\"http://localhost:8080/api/newsong/post/\".concat(userId),songs,axiosConfig);case 6:// console.log(songs)\n// console.log(tags)\nnavigate('/');// const response = await axios.put(`http://localhost:8080/api/annoy/recommend-songs/${userId}`);\n// setReco(response.data);\n// console.log(response.data);\n// navigate(\"/path/to/Tagresult\", { state: { reco: response.data } });\n_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](3);console.log(_context.t0);setShowAlert(true);// 경고창 노출 상태 변경\ncase 13:case\"end\":return _context.stop();}},_callee,null,[[3,9]]);}));return function handleRecommendSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Recommend2,{setSelectedSongs:handleSelectedSongsChange,setSelectedIds:handleSelectedIdsChange}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',marginTop:'40px'},children:/*#__PURE__*/_jsx(\"button\",{className:\"submit-btn\",onClick:handleRecommendSubmit,children:\"\\uC120\\uD0DD \\uC644\\uB8CC\"})})]}),showAlert&&/*#__PURE__*/_jsx(\"div\",{className:\"recommend-alert\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"recommend-alert-modal\",children:[/*#__PURE__*/_jsx(\"p\",{style:{marginBottom:'20px'},children:\"\\uC608\\uC0C1\\uCE58 \\uBABB\\uD55C \\uC624\\uB958\\uAC00 \\uBC1C\\uC0DD\\uD558\\uC600\\uC2B5\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:closeAlert,children:\"\\uB2EB\\uAE30\"})]})})]});}export default Signrecommend;","map":{"version":3,"names":["React","useState","useNavigate","axios","Recommend1","Recommend2","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Signrecommend","props","navigate","_useState","_useState2","_slicedToArray","showAlert","setShowAlert","closeAlert","_useState3","_useState4","reco","setReco","_useState5","Set","_useState6","selectedSongs","setSelectedSongs","selectedSongsArray","Array","from","_useState7","_useState8","selectedIds","setSelectedIds","selectedIdsArray","axiosConfig","headers","handleSelectedSongsChange","songs","handleSelectedIdsChange","ids","handleRecommendSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","userId","wrap","_callee$","_context","prev","next","preventDefault","song_ids","JSON","stringify","parse","localStorage","getItem","id","put","concat","t0","console","log","stop","_x","apply","arguments","children","style","display","justifyContent","marginTop","className","onClick","marginBottom"],"sources":["C:/박현호/프로젝트/react-jwt-auth/src/components/Signrecommend.js"],"sourcesContent":["import React from 'react';\r\nimport { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport Recommend1 from './Recommend1';\r\nimport Recommend2 from './Recommend2';\r\n\r\n\r\nfunction Signrecommend(props){\r\n    const navigate = useNavigate();\r\n    const [showAlert, setShowAlert] = useState(false); // 경고창 노출 여부 상태 추가  \r\n    const closeAlert = () => {\r\n        setShowAlert(false); // 경고창 닫기\r\n      };\r\n    const [reco, setReco] = useState([]);\r\n\r\n    // const [selectedItems, setSelectedItems] = useState(new Set());\r\n    // const selectedItemsArray = Array.from(selectedItems);\r\n\r\n    const [selectedSongs, setSelectedSongs] = useState(new Set());\r\n    const selectedSongsArray = Array.from(selectedSongs);\r\n\r\n    const [selectedIds, setSelectedIds] = useState(new Set());    \r\n    const selectedIdsArray = Array.from(selectedIds);\r\n\r\n    const axiosConfig = {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    };\r\n\r\n    // const handleSelectedItemsChange = (items) => {\r\n    //   setSelectedItems(new Set(items));\r\n    // };    \r\n\r\n    const handleSelectedSongsChange = (songs) => {\r\n      setSelectedSongs(new Set(songs));\r\n    };\r\n\r\n    const handleSelectedIdsChange = (ids) => {\r\n      setSelectedIds(new Set(ids));\r\n    };\r\n\r\n    const handleRecommendSubmit = async (e) => {\r\n        e.preventDefault();\r\n        // 선택한 장르와 노래 목록을 서버로 전송\r\n        // const tags = {\r\n        //   tag: JSON.stringify(selectedItemsArray),\r\n        // };\r\n\r\n        const songs = {\r\n          song_ids : JSON.stringify(selectedIdsArray),\r\n        };\r\n\r\n        const userId = JSON.parse(localStorage.getItem('user')).id;\r\n        \r\n        \r\n        try{\r\n          // 2023-08-01\r\n          // await 뺏음\r\n          // 왜 why? axios는 기본적으로 비동기형 통신장치라 await을 불필요하게 쓰면\r\n          // 비동기형 통신장치의 이점을 살리지 못 함.\r\n          // axios.put(`http://localhost:8080/api/tag/post/${userId}`, tags, axiosConfig);\r\n          await axios.put(`http://localhost:8080/api/newsong/post/${userId}`, songs, axiosConfig);\r\n          // console.log(songs)\r\n          // console.log(tags)\r\n          navigate('/');\r\n          // const response = await axios.put(`http://localhost:8080/api/annoy/recommend-songs/${userId}`);\r\n          // setReco(response.data);\r\n          // console.log(response.data);\r\n          // navigate(\"/path/to/Tagresult\", { state: { reco: response.data } });\r\n\r\n        } catch (error) {\r\n        console.log(error);\r\n        setShowAlert(true); // 경고창 노출 상태 변경\r\n        }\r\n\r\n    };\r\n\r\n\r\n\r\nreturn <>\r\n<div>\r\n\r\n{/* <img src=\"watermelon_logo.jpg\" alt=\"Watermelon\" style={{ width: '250px', height: 'auto', marginLeft: '394px', marginTop : '25px'}} />     */}\r\n\r\n{/* <Recommend1 setSelectedItems={handleSelectedItemsChange} /> */}\r\n\r\n<Recommend2 setSelectedSongs={handleSelectedSongsChange} setSelectedIds={handleSelectedIdsChange} />\r\n\r\n<div style={{ display: 'flex', justifyContent: 'center', marginTop : '40px' }}>\r\n<button className = 'submit-btn' onClick={handleRecommendSubmit}>선택 완료</button>\r\n</div>\r\n\r\n</div>\r\n\r\n{showAlert && (\r\n        <div className=\"recommend-alert\">\r\n          <div className=\"recommend-alert-modal\">\r\n            <p style={{marginBottom : '20px'}}>예상치 못한 오류가 발생하였습니다.</p>\r\n            <button onClick={closeAlert}>닫기</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n</>\r\n}\r\n\r\nexport default Signrecommend;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}