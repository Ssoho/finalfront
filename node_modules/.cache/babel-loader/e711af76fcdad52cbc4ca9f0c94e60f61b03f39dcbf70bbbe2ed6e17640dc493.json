{"ast":null,"code":"import _regeneratorRuntime from\"C:/\\uBC15\\uD604\\uD638/\\uD504\\uB85C\\uC81D\\uD2B8/react-jwt-auth/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/\\uBC15\\uD604\\uD638/\\uD504\\uB85C\\uC81D\\uD2B8/react-jwt-auth/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/\\uBC15\\uD604\\uD638/\\uD504\\uB85C\\uC81D\\uD2B8/react-jwt-auth/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{useState}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import Recommend1 from'./Recommend1';import Recommend2 from'./Recommend2';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Signrecommend(props){var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showAlert=_useState2[0],setShowAlert=_useState2[1];// 경고창 노출 여부 상태 추가  \nvar closeAlert=function closeAlert(){setShowAlert(false);// 경고창 닫기\n};var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),reco=_useState4[0],setReco=_useState4[1];var _useState5=useState(new Set()),_useState6=_slicedToArray(_useState5,2),selectedItems=_useState6[0],setSelectedItems=_useState6[1];var selectedItemsArray=Array.from(selectedItems);var _useState7=useState(new Set()),_useState8=_slicedToArray(_useState7,2),selectedSongs=_useState8[0],setSelectedSongs=_useState8[1];var selectedSongsArray=Array.from(selectedSongs);var _useState9=useState(new Set()),_useState10=_slicedToArray(_useState9,2),selectedIds=_useState10[0],setSelectedIds=_useState10[1];var selectedIdsArray=Array.from(selectedIds);var axiosConfig={headers:{'Content-Type':'application/json'}};var handleSelectedItemsChange=function handleSelectedItemsChange(items){setSelectedItems(new Set(items));};var handleSelectedSongsChange=function handleSelectedSongsChange(songs){setSelectedSongs(new Set(songs));};var handleSelectedIdsChange=function handleSelectedIdsChange(ids){setSelectedIds(new Set(ids));};var handleRecommendSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var tags,songs,userId;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();// 선택한 장르와 노래 목록을 서버로 전송\ntags={tag:JSON.stringify(selectedItemsArray)};songs={song_ids:JSON.stringify(selectedIdsArray)};userId=JSON.parse(localStorage.getItem('user')).id;try{// 2023-08-01\n// await 뺏음\n// 왜 why? axios는 기본적으로 비동기형 통신장치라 await을 불필요하게 쓰면\n// 비동기형 통신장치의 이점을 살리지 못 함.\naxios.put(\"http://localhost:8080/api/tag/post/\".concat(userId),tags,axiosConfig);axios.put(\"http://localhost:8080/api/newsong/post/\".concat(userId),songs,axiosConfig);// console.log(songs)\n// console.log(tags)\nnavigate('/');// const response = await axios.put(`http://localhost:8080/api/annoy/recommend-songs/${userId}`);\n// setReco(response.data);\n// console.log(response.data);\n// navigate(\"/path/to/Tagresult\", { state: { reco: response.data } });\n}catch(error){console.log(error);setShowAlert(true);// 경고창 노출 상태 변경\n}case 5:case\"end\":return _context.stop();}},_callee);}));return function handleRecommendSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Recommend1,{setSelectedItems:handleSelectedItemsChange}),/*#__PURE__*/_jsx(Recommend2,{setSelectedSongs:handleSelectedSongsChange,setSelectedIds:handleSelectedIdsChange}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',marginTop:'40px'},children:/*#__PURE__*/_jsx(\"button\",{className:\"submit-btn\",onClick:handleRecommendSubmit,children:\"\\uC804\\uC1A1\"})})]}),showAlert&&/*#__PURE__*/_jsx(\"div\",{className:\"recommend-alert\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"recommend-alert-modal\",children:[/*#__PURE__*/_jsx(\"p\",{style:{marginBottom:'20px'},children:\"\\uC608\\uC0C1\\uCE58 \\uBABB\\uD55C \\uC624\\uB958\\uAC00 \\uBC1C\\uC0DD\\uD558\\uC600\\uC2B5\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:closeAlert,children:\"\\uB2EB\\uAE30\"})]})})]});}export default Signrecommend;","map":{"version":3,"names":["React","useState","useNavigate","axios","Recommend1","Recommend2","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Signrecommend","props","navigate","_useState","_useState2","_slicedToArray","showAlert","setShowAlert","closeAlert","_useState3","_useState4","reco","setReco","_useState5","Set","_useState6","selectedItems","setSelectedItems","selectedItemsArray","Array","from","_useState7","_useState8","selectedSongs","setSelectedSongs","selectedSongsArray","_useState9","_useState10","selectedIds","setSelectedIds","selectedIdsArray","axiosConfig","headers","handleSelectedItemsChange","items","handleSelectedSongsChange","songs","handleSelectedIdsChange","ids","handleRecommendSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","tags","userId","wrap","_callee$","_context","prev","next","preventDefault","tag","JSON","stringify","song_ids","parse","localStorage","getItem","id","put","concat","error","console","log","stop","_x","apply","arguments","children","style","display","justifyContent","marginTop","className","onClick","marginBottom"],"sources":["C:/박현호/프로젝트/react-jwt-auth/src/components/Signrecommend.js"],"sourcesContent":["import React from 'react';\r\nimport { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport Recommend1 from './Recommend1';\r\nimport Recommend2 from './Recommend2';\r\n\r\n\r\nfunction Signrecommend(props){\r\n    const navigate = useNavigate();\r\n    const [showAlert, setShowAlert] = useState(false); // 경고창 노출 여부 상태 추가  \r\n    const closeAlert = () => {\r\n        setShowAlert(false); // 경고창 닫기\r\n      };\r\n    const [reco, setReco] = useState([]);\r\n\r\n    const [selectedItems, setSelectedItems] = useState(new Set());\r\n    const selectedItemsArray = Array.from(selectedItems);\r\n\r\n    const [selectedSongs, setSelectedSongs] = useState(new Set());\r\n    const selectedSongsArray = Array.from(selectedSongs);\r\n\r\n    const [selectedIds, setSelectedIds] = useState(new Set());    \r\n    const selectedIdsArray = Array.from(selectedIds);\r\n\r\n    const axiosConfig = {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    };\r\n\r\n    const handleSelectedItemsChange = (items) => {\r\n      setSelectedItems(new Set(items));\r\n    };    \r\n\r\n    const handleSelectedSongsChange = (songs) => {\r\n      setSelectedSongs(new Set(songs));\r\n    };\r\n\r\n    const handleSelectedIdsChange = (ids) => {\r\n      setSelectedIds(new Set(ids));\r\n    };\r\n\r\n    const handleRecommendSubmit = async (e) => {\r\n        e.preventDefault();\r\n        // 선택한 장르와 노래 목록을 서버로 전송\r\n        const tags = {\r\n          tag: JSON.stringify(selectedItemsArray),\r\n        };\r\n\r\n        const songs = {\r\n          song_ids : JSON.stringify(selectedIdsArray),\r\n        };\r\n\r\n        const userId = JSON.parse(localStorage.getItem('user')).id;\r\n        \r\n        try{\r\n          // 2023-08-01\r\n          // await 뺏음\r\n          // 왜 why? axios는 기본적으로 비동기형 통신장치라 await을 불필요하게 쓰면\r\n          // 비동기형 통신장치의 이점을 살리지 못 함.\r\n          axios.put(`http://localhost:8080/api/tag/post/${userId}`, tags, axiosConfig);\r\n          axios.put(`http://localhost:8080/api/newsong/post/${userId}`, songs, axiosConfig);\r\n          // console.log(songs)\r\n          // console.log(tags)\r\n          navigate('/');\r\n          // const response = await axios.put(`http://localhost:8080/api/annoy/recommend-songs/${userId}`);\r\n          // setReco(response.data);\r\n          // console.log(response.data);\r\n          // navigate(\"/path/to/Tagresult\", { state: { reco: response.data } });\r\n\r\n        } catch (error) {\r\n        console.log(error);\r\n        setShowAlert(true); // 경고창 노출 상태 변경\r\n        }\r\n\r\n    };\r\n\r\n\r\n\r\nreturn <>\r\n<div>\r\n\r\n{/* <img src=\"watermelon_logo.jpg\" alt=\"Watermelon\" style={{ width: '250px', height: 'auto', marginLeft: '394px', marginTop : '25px'}} />     */}\r\n\r\n<Recommend1 setSelectedItems={handleSelectedItemsChange} />\r\n\r\n<Recommend2 setSelectedSongs={handleSelectedSongsChange} setSelectedIds={handleSelectedIdsChange} />\r\n\r\n<div style={{ display: 'flex', justifyContent: 'center', marginTop : '40px' }}>\r\n<button className = 'submit-btn' onClick={handleRecommendSubmit}>전송</button>\r\n</div>\r\n\r\n</div>\r\n\r\n{showAlert && (\r\n        <div className=\"recommend-alert\">\r\n          <div className=\"recommend-alert-modal\">\r\n            <p style={{marginBottom : '20px'}}>예상치 못한 오류가 발생하였습니다.</p>\r\n            <button onClick={closeAlert}>닫기</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n</>\r\n}\r\n\r\nexport default Signrecommend;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}